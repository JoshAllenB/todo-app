(()=>{"use strict";function e(){const e=document.createElement("div");e.id="todoModal",e.classList.add("modal");const o=document.createElement("div");o.classList.add("modal-content");const d=document.createElement("span");d.classList.add("close"),d.innerHTML="&times;";const c=t("Task Name:","todoName"),l=n("text","todoName",!0),i=t("Date:","todoDate"),a=n("date","todoDate",!0),s=document.createElement("button");return s.id="submitTodo",s.textContent="Submit",o.appendChild(d),o.appendChild(c),o.appendChild(l),o.appendChild(i),o.appendChild(a),o.appendChild(s),e.appendChild(o),e}function t(e,t){const n=document.createElement("label");return n.setAttribute("for",t),n.textContent=e,n}function n(e,t,n){const o=document.createElement("input");return o.type=e,o.id=t,o.required=n,o}function o(e){const t=document.querySelector(".close");t&&t.addEventListener("click",(function(){e.style.display="none",console.log("Hotdog Clicked"),e.remove()}))}function d(){const e=document.getElementById("submitTodo"),t=document.getElementById("todoModal"),n=document.querySelector(".todoList");let o=document.querySelector(".todo-item-wrapper");o||(o=document.createElement("div"),o.classList.add("todo-item-wrapper")),e&&t&&n&&o&&e.addEventListener("click",(function(){const e=document.getElementById("todoName").value,d=document.getElementById("todoDate").value,c=document.createElement("div");c.classList.add("todo-item");const l=document.createElement("span");l.classList.add("checkmark");const i=document.createElement("input");i.type="checkbox";const a=document.createElement("h3");a.textContent=e;const s=document.createElement("p");s.textContent=d,l.appendChild(i),c.appendChild(l),c.appendChild(a),c.appendChild(s),o.appendChild(c),new Date(d);const r=Array.from(o.children).sort(((e,t)=>new Date(e.querySelector("p").textContent)-new Date(t.querySelector("p").textContent)));o.innerHTML="",r.forEach((e=>{o.appendChild(e)})),o.parentElement||n.appendChild(o),t.style.display="none",t.remove(),i.addEventListener("change",(function(){i.checked&&setTimeout((()=>{c.remove()}),200)}))}))}window.addEventListener("load",(function(){!function(){console.log("Entering projectHandler");const t=document.getElementById("add-project");if(t){const n=document.querySelector(".project"),o=function(){if(console.log("Entering clickHandler"),n&&n.querySelector(".project-input-container"))return void console.log("Input field already created. Exiting clickHandler.");const t=document.createElement("input");t.type="text",t.placeholder="Enter project name";const o=document.createElement("button");o.textContent="Submit",o.classList.add("submit-btn");const d=document.createElement("button");d.textContent="Cancel",d.classList.add("cancel-btn");const c=document.createElement("div");c.classList.add("project-input-container"),c.appendChild(t),c.appendChild(o),c.appendChild(d),o.addEventListener("click",(function(){console.log("Submit button clicked");const o=t.value.trim();if(o){console.log("Project Name:",o);const t=document.createElement("div");t.classList.add("project-item");const d=document.createElement("button");d.textContent=o,d.classList.add("projNameBtn");const l=document.createElement("button");l.textContent="x",l.classList.add("delete-btn"),l.addEventListener("click",(function(){t.remove();const e=document.querySelector(`.project-todo-list[data-project="${o}"]`);e&&e.remove()})),t.appendChild(d),t.appendChild(l),n.appendChild(t),c.remove();let i=document.createElement("div");i.classList.add("project-todo-list","hidden"),i.dataset.project=o;const a=document.createElement("button");a.textContent=`Add Todo for ${o}`,a.classList.add("add-todo-btn"),a.addEventListener("click",(function(){const t=e();document.getElementById("mainContent").appendChild(t),function(e){console.log("Entering closeModal");const t=document.querySelector(".close");t&&t.addEventListener("click",(function(){e.style.display="none",console.log("Close button clicked"),e.remove()})),console.log("Exiting closeModal")}(t),function(e,t){console.log("Entering submitTodoForProject");const n=document.querySelector(`.project-todo-list[data-project="${e}"]`);let o=document.querySelector(`.project-wrapper[data-project="${e}"]`);if(!o){o=document.createElement("div"),o.classList.add("project-wrapper"),o.dataset.project=e;const t=document.querySelector(".todoList");t&&t.appendChild(o),n.appendChild(o)}if(t&&o){n.appendChild(t);const e=document.getElementById("submitTodo"),d=function(){console.log("Submit Todo button clicked");const n=document.getElementById("todoName").value,c=document.getElementById("todoDate").value,l=document.createElement("div");l.classList.add("todo-item");const i=document.createElement("span");i.classList.add("checkmark");const a=document.createElement("input");a.type="checkbox";const s=document.createElement("h3");s.textContent=n;const r=document.createElement("p");r.textContent=c,i.appendChild(a),l.appendChild(i),l.appendChild(s),l.appendChild(r),o.appendChild(l);const u=Array.from(o.children).sort(((e,t)=>(e.querySelector("p")?new Date(e.querySelector("p").textContent):null)-(t.querySelector("p")?new Date(t.querySelector("p").textContent):null)));o.innerHTML="",u.forEach((e=>{o.appendChild(e)})),t.style.display="none",t.remove(),e.removeEventListener("click",d)};e.addEventListener("click",d),o.addEventListener("change",(function(e){const t=e.target;"INPUT"===t.tagName&&"checkbox"===t.type&&setTimeout((()=>{const e=t.closest(".todo-item");e&&e.remove()}),200)}))}console.log("Exiting submitTodoForProject")}(o,t)})),i.appendChild(a);const s=document.querySelector(".todoList");s&&s.appendChild(i),d.addEventListener("click",(function(){document.querySelectorAll(".project-todo-list").forEach((e=>{e.classList.add("hidden")})),i.classList.remove("hidden")}))}else alert("Please enter a project name.")})),d.addEventListener("click",(function(){c.remove()})),n&&n.appendChild(c),console.log("Exiting clickHandler")};t.addEventListener("click",o)}console.log("Exiting projectHandler")}()})),function(){!function(){const e=document.createElement("header"),t=document.createElement("h1");t.textContent="To-Do List",e.appendChild(t),document.body.appendChild(e)}();const t=function(){const e=document.createElement("div");return e.classList.add("content"),e.setAttribute("id","mainContent"),e}(),n=function(){const e=document.createElement("div");e.classList.add("todoList");const t=document.createElement("button");return t.classList.add("todoBtn"),t.textContent="Add To-Do List",e.appendChild(t),e}();!function(e){const t=document.createElement("div");function n(e,t){const n=document.createElement("button");return n.textContent=e,n.id=t,n}t.classList.add("sideMenu");const o=document.createElement("div");o.classList.add("home"),o.innerHTML="<h1>Home</h1>";const d=n("Inbox","inbox");o.appendChild(d),o.appendChild(n("Today","today")),o.appendChild(n("This Week","this-week"));const c=document.createElement("div");c.classList.add("project"),c.innerHTML="<h1>Project</h1>";const l=n("+ Add Project","add-project");c.appendChild(l),t.appendChild(o),t.appendChild(c),e.appendChild(t),document.body.appendChild(e)}(t),t.appendChild(n),function(){const e=document.querySelector(".sideMenu");e&&e.querySelectorAll("button").forEach((t=>{t.addEventListener("click",(()=>{e.querySelectorAll("button").forEach((e=>e.classList.remove("active"))),t.classList.add("active");const n=document.querySelector(".todoBtn"),o=document.getElementById("todoModal");"inbox"!==t.id&&(n.style.display="none",o&&(o.style.display="none"))}))}))}(),function(){const t=document.querySelector(".todoBtn"),n=document.getElementById("inbox"),c=document.getElementById("mainContent");t&&n&&(t.style.display=n.classList.contains("active")?"block":"none",n.addEventListener("click",(function(){t.style.display="block"})),t.addEventListener("click",(function(){const t=e();c.appendChild(t),o(t),d()})))}(),o(),d(),function(){const e=document.createElement("footer"),t=document.createElement("div");t.classList.add("link");const n=function(e){const t=document.createElement("h1");return t.innerHTML='Copyright <i class="fa-regular fa-copyright"></i> JoshAllen',t}();t.appendChild(n),e.appendChild(t),document.body.appendChild(e)}()}()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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OUtKLFdBQ0UsTUFBT3lFLEVBQVN6RyxTQUFTQyxjQUFjLFVBQ2pDeUcsRUFBYTFHLFNBQVNDLGNBQWMsT0FDMUN5RyxFQUFXdkcsVUFBVUMsSUFBSSxRQUV6QixNQUFNdUcsRUFNUixTQUEwQjFGLEdBQ3hCLE1BQU0yRixFQUFPNUcsU0FBU0MsY0FBYyxNQUVwQyxPQURBMkcsRUFBS3JHLFVBUjhCLDhEQVM1QnFHLENBQ1QsQ0FWb0JDLEdBQ2xCSCxFQUFXMUYsWUFBWTJGLEdBQ3ZCRixFQUFPekYsWUFBWTBGLEdBQ25CMUcsU0FBU3lGLEtBQUt6RSxZQUFZeUYsRUFDNUIsQ0FxRUVLLEVBQ0YsQ0N4RkFDLEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90b2RvLWFwcC8uL3NyYy9tb2RhbC5qcyIsIndlYnBhY2s6Ly90b2RvLWFwcC8uL3NyYy9ob21lSGFuZGxlci5qcyIsIndlYnBhY2s6Ly90b2RvLWFwcC8uL3NyYy9wcm9qSGFuZGxlci5qcyIsIndlYnBhY2s6Ly90b2RvLWFwcC8uL3NyYy93ZWJzaXRlLmpzIiwid2VicGFjazovL3RvZG8tYXBwLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGZvcm1hdCB9IGZyb20gJ2RhdGUtZm5zJztcblxuZnVuY3Rpb24gY3JlYXRlTW9kYWwoKSB7XG4gIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIG1vZGFsLmlkID0gJ3RvZG9Nb2RhbCc7XG4gIG1vZGFsLmNsYXNzTGlzdC5hZGQoJ21vZGFsJyk7XG5cbiAgY29uc3QgbW9kYWxDb250ZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIG1vZGFsQ29udGVudC5jbGFzc0xpc3QuYWRkKCdtb2RhbC1jb250ZW50Jyk7XG5cbiAgY29uc3QgY2xvc2VCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gIGNsb3NlQnRuLmNsYXNzTGlzdC5hZGQoJ2Nsb3NlJyk7XG4gIGNsb3NlQnRuLmlubmVySFRNTCA9ICcmdGltZXM7JztcblxuICBjb25zdCBuYW1lTGFiZWwgPSBjcmVhdGVMYWJlbCgnVGFzayBOYW1lOicsICd0b2RvTmFtZScpO1xuICBjb25zdCBuYW1lSW5wdXQgPSBjcmVhdGVJbnB1dCgndGV4dCcsICd0b2RvTmFtZScsIHRydWUpO1xuXG4gIGNvbnN0IGRhdGVMYWJlbCA9IGNyZWF0ZUxhYmVsKCdEYXRlOicsICd0b2RvRGF0ZScpO1xuICBjb25zdCBkYXRlSW5wdXQgPSBjcmVhdGVJbnB1dCgnZGF0ZScsICd0b2RvRGF0ZScsIHRydWUpO1xuXG4gIGNvbnN0IHN1Ym1pdEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICBzdWJtaXRCdG4uaWQgPSAnc3VibWl0VG9kbyc7XG4gIHN1Ym1pdEJ0bi50ZXh0Q29udGVudCA9ICdTdWJtaXQnO1xuXG4gIG1vZGFsQ29udGVudC5hcHBlbmRDaGlsZChjbG9zZUJ0bik7XG4gIG1vZGFsQ29udGVudC5hcHBlbmRDaGlsZChuYW1lTGFiZWwpO1xuICBtb2RhbENvbnRlbnQuYXBwZW5kQ2hpbGQobmFtZUlucHV0KTtcbiAgbW9kYWxDb250ZW50LmFwcGVuZENoaWxkKGRhdGVMYWJlbCk7XG4gIG1vZGFsQ29udGVudC5hcHBlbmRDaGlsZChkYXRlSW5wdXQpO1xuICBtb2RhbENvbnRlbnQuYXBwZW5kQ2hpbGQoc3VibWl0QnRuKTtcblxuICBtb2RhbC5hcHBlbmRDaGlsZChtb2RhbENvbnRlbnQpO1xuXG4gIHJldHVybiBtb2RhbDtcbn1cblxuZnVuY3Rpb24gY3JlYXRlTGFiZWwodGV4dCwgaHRtbEZvcikge1xuICBjb25zdCBsYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJyk7XG4gIGxhYmVsLnNldEF0dHJpYnV0ZSgnZm9yJywgaHRtbEZvcik7XG4gIGxhYmVsLnRleHRDb250ZW50ID0gdGV4dDtcbiAgcmV0dXJuIGxhYmVsO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVJbnB1dCh0eXBlLCBpZCwgcmVxdWlyZWQpIHtcbiAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICBpbnB1dC50eXBlID0gdHlwZTtcbiAgaW5wdXQuaWQgPSBpZDtcbiAgaW5wdXQucmVxdWlyZWQgPSByZXF1aXJlZDtcbiAgcmV0dXJuIGlucHV0O1xufVxuXG5leHBvcnQgeyBjcmVhdGVNb2RhbCB9O1xuIiwiaW1wb3J0IHsgY3JlYXRlTW9kYWwgfSBmcm9tIFwiLi9tb2RhbFwiO1xuaW1wb3J0IHsgcHJvamVjdEhhbmRsZXIgfSBmcm9tIFwiLi9wcm9qSGFuZGxlclwiO1xuXG5mdW5jdGlvbiBob21lSGFuZGxlcigpIHtcbmNvbnN0IHNpZGVNZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNpZGVNZW51Jyk7XG5cbiAgaWYgKHNpZGVNZW51KSB7XG4gICAgc2lkZU1lbnUucXVlcnlTZWxlY3RvckFsbCgnYnV0dG9uJykuZm9yRWFjaChidXR0b24gPT4ge1xuICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBzaWRlTWVudS5xdWVyeVNlbGVjdG9yQWxsKCdidXR0b24nKS5mb3JFYWNoKGIgPT4gYi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKSk7XG4gICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcblxuICAgICAgICBjb25zdCB0b2RvQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRvZG9CdG4nKTtcbiAgICAgICAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9kb01vZGFsJyk7XG5cbiAgICAgICAgaWYgKGJ1dHRvbi5pZCAhPT0gJ2luYm94Jykge1xuICAgICAgICAgIHRvZG9CdG4uc3R5bGUuZGlzcGxheSA9ICdub25lJztcblxuICAgICAgICAgIGlmIChtb2RhbCkge1xuICAgICAgICAgICAgbW9kYWwuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBpZiB0aGUgY2xpY2tlZCBidXR0b24gaXMgdGhlIHByb2plY3QgYnV0dG9uXG4gICAgICAgIGlmIChidXR0b24uaWQgPT09ICdhZGQtcHJvamVjdCcpIHtcbiAgICAgICAgICAvLyBIYW5kbGUgdGhlIHByb2plY3QgYnV0dG9uIGNsaWNrXG4gICAgICAgICAgcHJvamVjdEhhbmRsZXIoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gYWN0aXZlQnRuKCkge1xuICBjb25zdCBzaWRlTWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zaWRlTWVudScpO1xuXG4gIGlmIChzaWRlTWVudSkge1xuICAgIHNpZGVNZW51LnF1ZXJ5U2VsZWN0b3JBbGwoJ2J1dHRvbicpLmZvckVhY2goYnV0dG9uID0+IHtcbiAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgc2lkZU1lbnUucXVlcnlTZWxlY3RvckFsbCgnYnV0dG9uJykuZm9yRWFjaChiID0+IGIuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJykpO1xuICAgICAgICBidXR0b24uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG5cbiAgICAgICAgY29uc3QgdG9kb0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50b2RvQnRuJyk7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZG9Nb2RhbCcpO1xuXG4gICAgICAgIGlmIChidXR0b24uaWQgIT09ICdpbmJveCcpIHtcbiAgICAgICAgICB0b2RvQnRuLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cbiAgICAgICAgICBpZiAobW9kYWwpIHtcbiAgICAgICAgICAgIG1vZGFsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cblxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gaW5ib3hIYW5kbGVyKCkge1xuICBjb25zdCB0b2RvQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRvZG9CdG4nKTtcbiAgY29uc3QgaW5ib3hCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5ib3gnKTtcbiAgY29uc3QgY29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluQ29udGVudCcpO1xuXG4gIGlmICh0b2RvQnRuICYmIGluYm94QnRuKSB7XG4gICAgLy8gU2V0IHRoZSBpbml0aWFsIHN0YXRlIG9mIHRoZSBidXR0b25cbiAgICB0b2RvQnRuLnN0eWxlLmRpc3BsYXkgPSBpbmJveEJ0bi5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpID8gJ2Jsb2NrJyA6ICdub25lJztcblxuICAgIC8vIEFkZCBhbiBldmVudCBsaXN0ZW5lciBmb3Igc3Vic2VxdWVudCBjbGlja3NcbiAgICBpbmJveEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgdG9kb0J0bi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICB9KTtcblxuICAgIHRvZG9CdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgIGNvbnN0IG1vZGFsID0gY3JlYXRlTW9kYWwoKTtcbiAgICAgIGNvbnRlbnQuYXBwZW5kQ2hpbGQobW9kYWwpO1xuICAgICAgY2xvc2VNb2RhbChtb2RhbCk7IC8vIEFkZCBldmVudCBsaXN0ZW5lciBhZnRlciBhcHBlbmRpbmcgdGhlIG1vZGFsXG4gICAgICBzdWJtaXRUb2RvKCk7XG4gICAgfSk7XG4gIH1cbn1cblxuICBmdW5jdGlvbiBjbG9zZU1vZGFsKG1vZGFsKSB7XG4gICAgY29uc3QgY2xvc2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2xvc2UnKTtcblxuICAgIGlmIChjbG9zZSkge1xuICAgICAgY2xvc2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgICAgbW9kYWwuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgY29uc29sZS5sb2coJ0hvdGRvZyBDbGlja2VkJylcblxuICAgICAgICBtb2RhbC5yZW1vdmUoKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG5mdW5jdGlvbiBzdWJtaXRUb2RvKCkge1xuICBjb25zdCBzdWJtaXRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3VibWl0VG9kbycpO1xuICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2RvTW9kYWwnKTtcbiAgY29uc3QgdG9kb0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudG9kb0xpc3QnKTtcblxuICAvLyBDcmVhdGUgYSBzaW5nbGUgd3JhcHBlciBkaXYgZm9yIGFsbCB0b2RvIGl0ZW1zXG4gIGxldCB0b2RvSXRlbVdyYXBwZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudG9kby1pdGVtLXdyYXBwZXInKTtcblxuICBpZiAoIXRvZG9JdGVtV3JhcHBlcikge1xuICAgIHRvZG9JdGVtV3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHRvZG9JdGVtV3JhcHBlci5jbGFzc0xpc3QuYWRkKCd0b2RvLWl0ZW0td3JhcHBlcicpO1xuICB9XG5cbiAgaWYgKHN1Ym1pdEJ0biAmJiBtb2RhbCAmJiB0b2RvTGlzdCAmJiB0b2RvSXRlbVdyYXBwZXIpIHtcbiAgICBzdWJtaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAvLyBHZXQgdmFsdWVzIGZyb20gdGhlIG1vZGFsIGlucHV0c1xuICAgICAgY29uc3QgdG9kb05hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9kb05hbWUnKS52YWx1ZTtcbiAgICAgIGNvbnN0IHRvZG9EYXRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZG9EYXRlJykudmFsdWU7XG5cbiAgICAgIC8vIENyZWF0ZSBhIG5ldyBkaXYgdG8gcmVwcmVzZW50IHRoZSB0b2RvIGl0ZW1cbiAgICAgIGNvbnN0IHRvZG9JdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICB0b2RvSXRlbS5jbGFzc0xpc3QuYWRkKCd0b2RvLWl0ZW0nKTsgLy8gQWRkIHRoZSBjaGVja2JveCBzdHlsZXNcblxuICAgICAgLy8gQ3JlYXRlIGEgc3BhbiB3aXRoIHRoZSBjaGVja21hcmsgY2xhc3NcbiAgICAgIGNvbnN0IGNoZWNrbWFya1NwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICBjaGVja21hcmtTcGFuLmNsYXNzTGlzdC5hZGQoJ2NoZWNrbWFyaycpO1xuXG4gICAgICAvLyBDcmVhdGUgYSBjaGVja2JveFxuICAgICAgY29uc3QgY2hlY2tib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgICAgY2hlY2tib3gudHlwZSA9ICdjaGVja2JveCc7XG5cbiAgICAgIC8vIENyZWF0ZSBoMyBhbmQgcCBlbGVtZW50cyBmb3IgdGhlIHRvZG8gbmFtZSBhbmQgZGF0ZVxuICAgICAgY29uc3QgbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpO1xuICAgICAgbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSB0b2RvTmFtZTtcblxuICAgICAgY29uc3QgZGF0ZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gICAgICBkYXRlRWxlbWVudC50ZXh0Q29udGVudCA9IHRvZG9EYXRlO1xuXG4gICAgICAvLyBBcHBlbmQgdGhlIGNoZWNrYm94IHRvIHRoZSBzcGFuLCBhbmQgdGhlIHNwYW4gdG8gdGhlIHRvZG8gaXRlbVxuICAgICAgY2hlY2ttYXJrU3Bhbi5hcHBlbmRDaGlsZChjaGVja2JveCk7XG4gICAgICB0b2RvSXRlbS5hcHBlbmRDaGlsZChjaGVja21hcmtTcGFuKTtcbiAgICAgIHRvZG9JdGVtLmFwcGVuZENoaWxkKG5hbWVFbGVtZW50KTtcbiAgICAgIHRvZG9JdGVtLmFwcGVuZENoaWxkKGRhdGVFbGVtZW50KTtcblxuICAgICAgLy8gQXBwZW5kIHRoZSB0b2RvIGl0ZW0gdG8gdGhlIGNvbW1vbiB3cmFwcGVyIGRpdlxuICAgICAgdG9kb0l0ZW1XcmFwcGVyLmFwcGVuZENoaWxkKHRvZG9JdGVtKTtcblxuICAgICAgLy8gQ29udmVydCB0aGUgZGF0ZSBzdHJpbmcgdG8gYSBKYXZhU2NyaXB0IERhdGUgb2JqZWN0XG4gICAgICBjb25zdCB0b2RvRGF0ZVRpbWUgPSBuZXcgRGF0ZSh0b2RvRGF0ZSk7XG5cbiAgICAgIC8vIFNvcnQgdG9kbyBpdGVtcyBiYXNlZCBvbiBkYXRlIGJlZm9yZSBhcHBlbmRpbmdcbiAgICAgIGNvbnN0IHNvcnRlZFRvZG9JdGVtcyA9IEFycmF5LmZyb20odG9kb0l0ZW1XcmFwcGVyLmNoaWxkcmVuKS5zb3J0KChhLCBiKSA9PiB7XG4gICAgICAgIGNvbnN0IGRhdGVBID0gbmV3IERhdGUoYS5xdWVyeVNlbGVjdG9yKCdwJykudGV4dENvbnRlbnQpO1xuICAgICAgICBjb25zdCBkYXRlQiA9IG5ldyBEYXRlKGIucXVlcnlTZWxlY3RvcigncCcpLnRleHRDb250ZW50KTtcbiAgICAgICAgcmV0dXJuIGRhdGVBIC0gZGF0ZUI7XG4gICAgICB9KTtcblxuICAgICAgLy8gQ2xlYXIgdGhlIGV4aXN0aW5nIHRvZG8gaXRlbXMgaW4gdGhlIHdyYXBwZXJcbiAgICAgIHRvZG9JdGVtV3JhcHBlci5pbm5lckhUTUwgPSAnJztcblxuICAgICAgLy8gQXBwZW5kIHRoZSBzb3J0ZWQgdG9kbyBpdGVtcyB0byB0aGUgd3JhcHBlciBkaXZcbiAgICAgIHNvcnRlZFRvZG9JdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICB0b2RvSXRlbVdyYXBwZXIuYXBwZW5kQ2hpbGQoaXRlbSk7XG4gICAgICB9KTtcblxuICAgICAgLy8gQXBwZW5kIHRoZSB3cmFwcGVyIGRpdiB0byB0aGUgdG9kb0xpc3QgZGl2IChpZiBub3QgYWxyZWFkeSBhcHBlbmRlZClcbiAgICAgIGlmICghdG9kb0l0ZW1XcmFwcGVyLnBhcmVudEVsZW1lbnQpIHtcbiAgICAgICAgdG9kb0xpc3QuYXBwZW5kQ2hpbGQodG9kb0l0ZW1XcmFwcGVyKTtcbiAgICAgIH1cblxuICAgICAgLy8gSGlkZSBhbmQgcmVtb3ZlIHRoZSBtb2RhbFxuICAgICAgbW9kYWwuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgIG1vZGFsLnJlbW92ZSgpO1xuXG4gICAgICAvLyBBZGQgZXZlbnQgbGlzdGVuZXIgdG8gdGhlIGNoZWNrYm94IGZvciByZW1vdmFsXG4gICAgICBjaGVja2JveC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChjaGVja2JveC5jaGVja2VkKSB7XG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB0b2RvSXRlbS5yZW1vdmUoKTtcbiAgICAgICAgICB9LCAyMDApO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxufVxuXG4gIGZ1bmN0aW9uIGluaXRIYW5kbGVyKCkge1xuICAgIGFjdGl2ZUJ0bigpO1xuICAgIGluYm94SGFuZGxlcigpO1xuICAgIGNsb3NlTW9kYWwoKTtcbiAgICBzdWJtaXRUb2RvKCk7XG4gIH1cblxuICBleHBvcnQgeyBpbml0SGFuZGxlciwgaW5ib3hIYW5kbGVyIH07IiwiaW1wb3J0IHsgY3JlYXRlTW9kYWwgfSBmcm9tIFwiLi9tb2RhbFwiO1xuXG5mdW5jdGlvbiBwcm9qZWN0SGFuZGxlcigpIHtcbiAgY29uc29sZS5sb2coXCJFbnRlcmluZyBwcm9qZWN0SGFuZGxlclwiKTtcblxuICBjb25zdCBhZGRQcm9qZWN0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FkZC1wcm9qZWN0Jyk7XG5cbiAgaWYgKGFkZFByb2plY3RCdG4pIHtcbiAgICBjb25zdCBwcm9qZWN0RGl2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3QnKTtcblxuICAgIGNvbnN0IGNsaWNrSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiRW50ZXJpbmcgY2xpY2tIYW5kbGVyXCIpO1xuXG4gICAgICBpZiAocHJvamVjdERpdiAmJiBwcm9qZWN0RGl2LnF1ZXJ5U2VsZWN0b3IoJy5wcm9qZWN0LWlucHV0LWNvbnRhaW5lcicpKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiSW5wdXQgZmllbGQgYWxyZWFkeSBjcmVhdGVkLiBFeGl0aW5nIGNsaWNrSGFuZGxlci5cIik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgaW5wdXRFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICAgIGlucHV0RWxlbWVudC50eXBlID0gJ3RleHQnO1xuICAgICAgaW5wdXRFbGVtZW50LnBsYWNlaG9sZGVyID0gJ0VudGVyIHByb2plY3QgbmFtZSc7XG5cbiAgICAgIGNvbnN0IHN1Ym1pdEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgICAgc3VibWl0QnRuLnRleHRDb250ZW50ID0gJ1N1Ym1pdCc7XG4gICAgICBzdWJtaXRCdG4uY2xhc3NMaXN0LmFkZCgnc3VibWl0LWJ0bicpO1xuXG4gICAgICBjb25zdCBjYW5jZWxCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICAgIGNhbmNlbEJ0bi50ZXh0Q29udGVudCA9ICdDYW5jZWwnO1xuICAgICAgY2FuY2VsQnRuLmNsYXNzTGlzdC5hZGQoJ2NhbmNlbC1idG4nKTtcblxuICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICBjb250YWluZXIuY2xhc3NMaXN0LmFkZCgncHJvamVjdC1pbnB1dC1jb250YWluZXInKTtcbiAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChpbnB1dEVsZW1lbnQpO1xuICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHN1Ym1pdEJ0bik7XG4gICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoY2FuY2VsQnRuKTtcblxuICAgICAgc3VibWl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIlN1Ym1pdCBidXR0b24gY2xpY2tlZFwiKTtcblxuICAgICAgICBjb25zdCBwcm9qZWN0TmFtZSA9IGlucHV0RWxlbWVudC52YWx1ZS50cmltKCk7XG5cbiAgICAgICAgaWYgKHByb2plY3ROYW1lKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1Byb2plY3QgTmFtZTonLCBwcm9qZWN0TmFtZSk7XG5cbiAgICAgICAgICBjb25zdCBwcm9qZWN0SXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgIHByb2plY3RJdGVtLmNsYXNzTGlzdC5hZGQoJ3Byb2plY3QtaXRlbScpO1xuICAgICAgICAgIGNvbnN0IHByb2plY3ROYW1lQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgICAgcHJvamVjdE5hbWVCdG4udGV4dENvbnRlbnQgPSBwcm9qZWN0TmFtZTtcbiAgICAgICAgICBwcm9qZWN0TmFtZUJ0bi5jbGFzc0xpc3QuYWRkKCdwcm9qTmFtZUJ0bicpO1xuXG4gICAgICAgICAgY29uc3QgZGVsZXRlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgICAgZGVsZXRlQnRuLnRleHRDb250ZW50ID0gJ3gnO1xuICAgICAgICAgIGRlbGV0ZUJ0bi5jbGFzc0xpc3QuYWRkKCdkZWxldGUtYnRuJyk7XG5cbiAgICAgICAgICBkZWxldGVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBwcm9qZWN0SXRlbS5yZW1vdmUoKTtcbiAgICAgICAgICAgIGNvbnN0IHByb2plY3RUb2RvTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5wcm9qZWN0LXRvZG8tbGlzdFtkYXRhLXByb2plY3Q9XCIke3Byb2plY3ROYW1lfVwiXWApO1xuICAgICAgICAgICAgaWYgKHByb2plY3RUb2RvTGlzdCkge1xuICAgICAgICAgICAgICBwcm9qZWN0VG9kb0xpc3QucmVtb3ZlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBwcm9qZWN0SXRlbS5hcHBlbmRDaGlsZChwcm9qZWN0TmFtZUJ0bik7XG4gICAgICAgICAgcHJvamVjdEl0ZW0uYXBwZW5kQ2hpbGQoZGVsZXRlQnRuKTtcblxuICAgICAgICAgIHByb2plY3REaXYuYXBwZW5kQ2hpbGQocHJvamVjdEl0ZW0pO1xuXG4gICAgICAgICAgY29udGFpbmVyLnJlbW92ZSgpO1xuXG4gICAgICAgICAgbGV0IHByb2plY3RUb2RvTGlzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgIHByb2plY3RUb2RvTGlzdC5jbGFzc0xpc3QuYWRkKCdwcm9qZWN0LXRvZG8tbGlzdCcsICdoaWRkZW4nKTtcbiAgICAgICAgICBwcm9qZWN0VG9kb0xpc3QuZGF0YXNldC5wcm9qZWN0ID0gcHJvamVjdE5hbWU7XG5cbiAgICAgICAgICBjb25zdCBhZGRUb2RvQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgICAgYWRkVG9kb0J0bi50ZXh0Q29udGVudCA9IGBBZGQgVG9kbyBmb3IgJHtwcm9qZWN0TmFtZX1gO1xuICAgICAgICAgIGFkZFRvZG9CdG4uY2xhc3NMaXN0LmFkZCgnYWRkLXRvZG8tYnRuJyk7XG5cbiAgICAgICAgICBhZGRUb2RvQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY29uc3QgbW9kYWwgPSBjcmVhdGVNb2RhbCgpO1xuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW5Db250ZW50JykuYXBwZW5kQ2hpbGQobW9kYWwpO1xuXG4gICAgICAgICAgICBjbG9zZU1vZGFsKG1vZGFsKTtcbiAgICAgICAgICAgIHN1Ym1pdFRvZG9Gb3JQcm9qZWN0KHByb2plY3ROYW1lLCBtb2RhbCk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBwcm9qZWN0VG9kb0xpc3QuYXBwZW5kQ2hpbGQoYWRkVG9kb0J0bik7XG5cbiAgICAgICAgICAvLyBBcHBlbmQgdGhlIHByb2plY3QgdG9kbyBsaXN0IHRvIHRoZSAudG9kb0xpc3QgZGl2XG4gICAgICAgICAgY29uc3QgdG9kb0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudG9kb0xpc3QnKTtcbiAgICAgICAgICBpZiAodG9kb0xpc3QpIHtcbiAgICAgICAgICAgIHRvZG9MaXN0LmFwcGVuZENoaWxkKHByb2plY3RUb2RvTGlzdCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gQWRkIGV2ZW50IGxpc3RlbmVyIHRvIHRvZ2dsZSB2aXNpYmlsaXR5IG9mIHByb2plY3QgdG9kbyBsaXN0XG4gICAgICAgICAgcHJvamVjdE5hbWVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvLyBIaWRlIGFsbCBwcm9qZWN0IHRvZG8gbGlzdHNcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wcm9qZWN0LXRvZG8tbGlzdCcpLmZvckVhY2gobGlzdCA9PiB7XG4gICAgICAgICAgICAgIGxpc3QuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gU2hvdyB0aGUgY2xpY2tlZCBwcm9qZWN0IHRvZG8gbGlzdFxuICAgICAgICAgICAgcHJvamVjdFRvZG9MaXN0LmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYWxlcnQoJ1BsZWFzZSBlbnRlciBhIHByb2plY3QgbmFtZS4nKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGNhbmNlbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29udGFpbmVyLnJlbW92ZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIGlmIChwcm9qZWN0RGl2KSB7XG4gICAgICAgIHByb2plY3REaXYuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcbiAgICAgIH1cblxuICAgICAgY29uc29sZS5sb2coXCJFeGl0aW5nIGNsaWNrSGFuZGxlclwiKTtcbiAgICB9O1xuXG4gICAgYWRkUHJvamVjdEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsaWNrSGFuZGxlcik7XG4gIH1cblxuICBjb25zb2xlLmxvZyhcIkV4aXRpbmcgcHJvamVjdEhhbmRsZXJcIik7XG59XG5cbmZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWwpIHtcbiAgY29uc29sZS5sb2coXCJFbnRlcmluZyBjbG9zZU1vZGFsXCIpO1xuXG4gIGNvbnN0IGNsb3NlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jbG9zZVwiKTtcblxuICBpZiAoY2xvc2UpIHtcbiAgICBjbG9zZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgbW9kYWwuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgY29uc29sZS5sb2coXCJDbG9zZSBidXR0b24gY2xpY2tlZFwiKTtcbiAgICAgIG1vZGFsLnJlbW92ZSgpO1xuICAgIH0pO1xuICB9XG5cbiAgY29uc29sZS5sb2coXCJFeGl0aW5nIGNsb3NlTW9kYWxcIik7XG59XG5cbmZ1bmN0aW9uIHN1Ym1pdFRvZG9Gb3JQcm9qZWN0KHByb2plY3ROYW1lLCBtb2RhbCkge1xuICBjb25zb2xlLmxvZyhcIkVudGVyaW5nIHN1Ym1pdFRvZG9Gb3JQcm9qZWN0XCIpO1xuXG4gIGNvbnN0IHByb2plY3RUb2RvTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgYC5wcm9qZWN0LXRvZG8tbGlzdFtkYXRhLXByb2plY3Q9XCIke3Byb2plY3ROYW1lfVwiXWBcbiAgKTtcblxuICBsZXQgcHJvamVjdFRvZG9JdGVtV3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgYC5wcm9qZWN0LXdyYXBwZXJbZGF0YS1wcm9qZWN0PVwiJHtwcm9qZWN0TmFtZX1cIl1gXG4gICk7XG5cbiAgaWYgKCFwcm9qZWN0VG9kb0l0ZW1XcmFwcGVyKSB7XG4gICAgcHJvamVjdFRvZG9JdGVtV3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgcHJvamVjdFRvZG9JdGVtV3JhcHBlci5jbGFzc0xpc3QuYWRkKFwicHJvamVjdC13cmFwcGVyXCIpO1xuICAgIHByb2plY3RUb2RvSXRlbVdyYXBwZXIuZGF0YXNldC5wcm9qZWN0ID0gcHJvamVjdE5hbWU7XG5cbiAgICAvLyBBcHBlbmQgdGhlIHByb2plY3Qtc3BlY2lmaWMgdG9kbyBsaXN0IHRvIHRoZSAudG9kb0xpc3QgZGl2XG4gICAgY29uc3QgdG9kb0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvZG9MaXN0XCIpO1xuICAgIGlmICh0b2RvTGlzdCkge1xuICAgICAgdG9kb0xpc3QuYXBwZW5kQ2hpbGQocHJvamVjdFRvZG9JdGVtV3JhcHBlcik7XG4gICAgfVxuICAgIHByb2plY3RUb2RvTGlzdC5hcHBlbmRDaGlsZChwcm9qZWN0VG9kb0l0ZW1XcmFwcGVyKTtcbiAgfVxuXG4gIGlmIChtb2RhbCAmJiBwcm9qZWN0VG9kb0l0ZW1XcmFwcGVyKSB7XG4gICAgcHJvamVjdFRvZG9MaXN0LmFwcGVuZENoaWxkKG1vZGFsKTtcblxuICAgIGNvbnN0IHN1Ym1pdEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3VibWl0VG9kb1wiKTtcblxuICAgIGNvbnN0IHN1Ym1pdEhhbmRsZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIlN1Ym1pdCBUb2RvIGJ1dHRvbiBjbGlja2VkXCIpO1xuXG4gICAgICBjb25zdCB0b2RvTmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidG9kb05hbWVcIikudmFsdWU7XG4gICAgICBjb25zdCB0b2RvRGF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidG9kb0RhdGVcIikudmFsdWU7XG5cbiAgICAgIGNvbnN0IHRvZG9JdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgIHRvZG9JdGVtLmNsYXNzTGlzdC5hZGQoXCJ0b2RvLWl0ZW1cIik7XG5cbiAgICAgIGNvbnN0IGNoZWNrbWFya1NwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcbiAgICAgIGNoZWNrbWFya1NwYW4uY2xhc3NMaXN0LmFkZChcImNoZWNrbWFya1wiKTtcblxuICAgICAgY29uc3QgY2hlY2tib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XG4gICAgICBjaGVja2JveC50eXBlID0gXCJjaGVja2JveFwiO1xuXG4gICAgICBjb25zdCBuYW1lRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJoM1wiKTtcbiAgICAgIG5hbWVFbGVtZW50LnRleHRDb250ZW50ID0gdG9kb05hbWU7XG5cbiAgICAgIGNvbnN0IGRhdGVFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIik7XG4gICAgICBkYXRlRWxlbWVudC50ZXh0Q29udGVudCA9IHRvZG9EYXRlO1xuXG4gICAgICBjaGVja21hcmtTcGFuLmFwcGVuZENoaWxkKGNoZWNrYm94KTtcbiAgICAgIHRvZG9JdGVtLmFwcGVuZENoaWxkKGNoZWNrbWFya1NwYW4pO1xuICAgICAgdG9kb0l0ZW0uYXBwZW5kQ2hpbGQobmFtZUVsZW1lbnQpO1xuICAgICAgdG9kb0l0ZW0uYXBwZW5kQ2hpbGQoZGF0ZUVsZW1lbnQpO1xuXG4gICAgICAvLyBBcHBlbmQgdGhlIHRvZG8gaXRlbSB0byB0aGUgcHJvamVjdC1zcGVjaWZpYyB0b2RvIGxpc3RcbiAgICAgIHByb2plY3RUb2RvSXRlbVdyYXBwZXIuYXBwZW5kQ2hpbGQodG9kb0l0ZW0pO1xuXG4gICAgICBjb25zdCBzb3J0ZWRUb2RvSXRlbXMgPSBBcnJheS5mcm9tKHByb2plY3RUb2RvSXRlbVdyYXBwZXIuY2hpbGRyZW4pLnNvcnQoXG4gICAgICAgIChhLCBiKSA9PiB7XG4gICAgICAgICAgY29uc3QgZGF0ZUEgPSBhLnF1ZXJ5U2VsZWN0b3IoXCJwXCIpXG4gICAgICAgICAgICA/IG5ldyBEYXRlKGEucXVlcnlTZWxlY3RvcihcInBcIikudGV4dENvbnRlbnQpXG4gICAgICAgICAgICA6IG51bGw7XG4gICAgICAgICAgY29uc3QgZGF0ZUIgPSBiLnF1ZXJ5U2VsZWN0b3IoXCJwXCIpXG4gICAgICAgICAgICA/IG5ldyBEYXRlKGIucXVlcnlTZWxlY3RvcihcInBcIikudGV4dENvbnRlbnQpXG4gICAgICAgICAgICA6IG51bGw7XG5cbiAgICAgICAgICByZXR1cm4gZGF0ZUEgLSBkYXRlQjtcbiAgICAgICAgfVxuICAgICAgKTtcblxuICAgICAgcHJvamVjdFRvZG9JdGVtV3JhcHBlci5pbm5lckhUTUwgPSBcIlwiO1xuXG4gICAgICBzb3J0ZWRUb2RvSXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICBwcm9qZWN0VG9kb0l0ZW1XcmFwcGVyLmFwcGVuZENoaWxkKGl0ZW0pO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIEhpZGUgYW5kIHJlbW92ZSB0aGUgbW9kYWxcbiAgICAgIG1vZGFsLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgIG1vZGFsLnJlbW92ZSgpO1xuXG4gICAgICAvLyBSZW1vdmUgdGhlIGV2ZW50IGxpc3RlbmVyIGFmdGVyIHN1Ym1pdHRpbmdcbiAgICAgIHN1Ym1pdEJ0bi5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgc3VibWl0SGFuZGxlcik7XG4gICAgfTtcblxuICAgIHN1Ym1pdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgc3VibWl0SGFuZGxlcik7XG5cbiAgICBwcm9qZWN0VG9kb0l0ZW1XcmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICBjb25zdCB0YXJnZXRDaGVja2JveCA9IGV2ZW50LnRhcmdldDtcbiAgICAgIGlmIChcbiAgICAgICAgdGFyZ2V0Q2hlY2tib3gudGFnTmFtZSA9PT0gXCJJTlBVVFwiICYmXG4gICAgICAgIHRhcmdldENoZWNrYm94LnR5cGUgPT09IFwiY2hlY2tib3hcIlxuICAgICAgKSB7XG4gICAgICAgIC8vIEFkZCBhIHNtYWxsIGRlbGF5IGZvciBDU1MgYW5pbWF0aW9uXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIC8vIFJlbW92ZSB0aGUgdG9kbyBpdGVtIHdoZW4gdGhlIGNoZWNrYm94IGlzIGNoZWNrZWRcbiAgICAgICAgICBjb25zdCB0b2RvSXRlbSA9IHRhcmdldENoZWNrYm94LmNsb3Nlc3QoXCIudG9kby1pdGVtXCIpO1xuICAgICAgICAgIGlmICh0b2RvSXRlbSkge1xuICAgICAgICAgICAgdG9kb0l0ZW0ucmVtb3ZlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9LCAyMDApOyAvLyBZb3UgY2FuIGFkanVzdCB0aGUgZGVsYXkgKGluIG1pbGxpc2Vjb25kcykgYXMgbmVlZGVkXG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBjb25zb2xlLmxvZyhcIkV4aXRpbmcgc3VibWl0VG9kb0ZvclByb2plY3RcIik7XG59XG5cbi8vIEFkZCBldmVudCBsaXN0ZW5lciB0byBsb2FkIHRoZSBwcm9qZWN0SGFuZGxlciB3aGVuIHRoZSB3aW5kb3cgbG9hZHNcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCBmdW5jdGlvbiAoKSB7XG4gIC8vIENhbGwgcHJvamVjdEhhbmRsZXIgd2hlbiB0aGUgd2luZG93IGxvYWRzXG4gIHByb2plY3RIYW5kbGVyKCk7XG59KTtcblxuZXhwb3J0IHsgcHJvamVjdEhhbmRsZXIgfTtcbiIsImltcG9ydCB7IGluaXRIYW5kbGVyIH0gZnJvbSBcIi4vaG9tZUhhbmRsZXJcIjtcblxuZnVuY3Rpb24gY3JlYXRlSGVhZGVyKCl7XG4gIGNvbnN0IGhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2hlYWRlcicpO1xuICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gxJyk7XG4gIHRpdGxlLnRleHRDb250ZW50ID0gJ1RvLURvIExpc3QnO1xuXG4gIGhlYWRlci5hcHBlbmRDaGlsZCh0aXRsZSk7XG4gIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoaGVhZGVyKTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlRm9vdGVyKCkge1xuICBjb25zdCAgZm9vdGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZm9vdGVyJyk7XG4gIGNvbnN0IGZvb3RlckxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgZm9vdGVyTGluay5jbGFzc0xpc3QuYWRkKCdsaW5rJyk7XG5cbiAgY29uc3QgY29weXJpZ2h0ID0gY3JlYXRlRm9vdGVyTGluaygnQ29weXJpZ2h0IDxpIGNsYXNzPVwiZmEtcmVndWxhciBmYS1jb3B5cmlnaHRcIj48L2k+IEpvc2hBbGxlbicpO1xuICBmb290ZXJMaW5rLmFwcGVuZENoaWxkKGNvcHlyaWdodCk7XG4gIGZvb3Rlci5hcHBlbmRDaGlsZChmb290ZXJMaW5rKTtcbiAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChmb290ZXIpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVGb290ZXJMaW5rKHRleHQpIHtcbiAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gxJyk7XG4gIGxpbmsuaW5uZXJIVE1MID0gdGV4dDtcbiAgcmV0dXJuIGxpbms7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUNvbnRlbnQoKSB7XG4gIGNvbnN0IGNvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgY29udGVudC5jbGFzc0xpc3QuYWRkKCdjb250ZW50Jyk7XG4gIGNvbnRlbnQuc2V0QXR0cmlidXRlKCdpZCcsICdtYWluQ29udGVudCcpO1xuICByZXR1cm4gY29udGVudDtcbn1cblxuZnVuY3Rpb24gY3JlYXRlU2lkZU1lbnUoY29udGVudCkge1xuICBjb25zdCBzaWRlTWVudSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBzaWRlTWVudS5jbGFzc0xpc3QuYWRkKCdzaWRlTWVudScpO1xuXG4gIGZ1bmN0aW9uIGNyZWF0ZUJ1dHRvbih0ZXh0LCBpZCkge1xuICAgIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgIGJ1dHRvbi50ZXh0Q29udGVudCA9IHRleHQ7XG4gICAgYnV0dG9uLmlkID0gaWQ7XG4gICAgcmV0dXJuIGJ1dHRvbjtcbiAgfVxuXG4gIGNvbnN0IGhvbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgaG9tZS5jbGFzc0xpc3QuYWRkKCdob21lJyk7XG4gIGhvbWUuaW5uZXJIVE1MID0gJzxoMT5Ib21lPC9oMT4nO1xuICBjb25zdCBpbmJveEJ0biA9IGNyZWF0ZUJ1dHRvbignSW5ib3gnLCAnaW5ib3gnKTtcbiAgaG9tZS5hcHBlbmRDaGlsZChpbmJveEJ0bik7XG4gIGhvbWUuYXBwZW5kQ2hpbGQoY3JlYXRlQnV0dG9uKCdUb2RheScsICd0b2RheScpKTtcbiAgaG9tZS5hcHBlbmRDaGlsZChjcmVhdGVCdXR0b24oJ1RoaXMgV2VlaycsICd0aGlzLXdlZWsnKSk7XG5cbiAgY29uc3QgcHJvamVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBwcm9qZWN0LmNsYXNzTGlzdC5hZGQoJ3Byb2plY3QnKTtcbiAgcHJvamVjdC5pbm5lckhUTUwgPSAnPGgxPlByb2plY3Q8L2gxPic7XG4gIGNvbnN0IGFkZFByb2plY3RCdG4gPSBjcmVhdGVCdXR0b24oJysgQWRkIFByb2plY3QnLCAnYWRkLXByb2plY3QnKTtcbiAgcHJvamVjdC5hcHBlbmRDaGlsZChhZGRQcm9qZWN0QnRuKTtcblxuICBzaWRlTWVudS5hcHBlbmRDaGlsZChob21lKTtcbiAgc2lkZU1lbnUuYXBwZW5kQ2hpbGQocHJvamVjdCk7XG4gIGNvbnRlbnQuYXBwZW5kQ2hpbGQoc2lkZU1lbnUpOyAvLyBBcHBlbmQgc2lkZU1lbnUgdG8gY29udGVudFxuICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGNvbnRlbnQpOyAvLyBBcHBlbmQgY29udGVudCB0byB0aGUgYm9keVxuXG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVRvZG9MaXN0KCkge1xuICBjb25zdCB0b2RvQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIHRvZG9Db250YWluZXIuY2xhc3NMaXN0LmFkZCgndG9kb0xpc3QnKTsgLy8gTmV3IGNvbnRhaW5lciBmb3IgdGhlIHRvZG8gbGlzdFxuXG4gIGNvbnN0IHRvZG9CdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgdG9kb0J0bi5jbGFzc0xpc3QuYWRkKCd0b2RvQnRuJyk7XG4gIHRvZG9CdG4udGV4dENvbnRlbnQgPSAnQWRkIFRvLURvIExpc3QnO1xuXG4gIHRvZG9Db250YWluZXIuYXBwZW5kQ2hpbGQodG9kb0J0bik7XG4gIC8vIGNvbnRlbnQuYXBwZW5kQ2hpbGQodG9kb0NvbnRhaW5lcik7IC8vIERvbid0IGFwcGVuZCBkaXJlY3RseSB0byBjb250ZW50XG5cbiAgcmV0dXJuIHRvZG9Db250YWluZXI7IC8vIFJldHVybiB0aGUgdG9kbyBjb250YWluZXJcbn1cblxuXG5mdW5jdGlvbiBpbml0V2Vic2l0ZSgpIHtcbiAgY3JlYXRlSGVhZGVyKCk7XG4gIGNvbnN0IGNvbnRlbnQgPSBjcmVhdGVDb250ZW50KCk7IC8vIENyZWF0ZSBjb250ZW50IGVsZW1lbnRcbiAgY29uc3QgdG9kb0NvbnRhaW5lciA9IGNyZWF0ZVRvZG9MaXN0KCk7IC8vIENyZWF0ZSB0b2RvIGNvbnRhaW5lclxuICBjcmVhdGVTaWRlTWVudShjb250ZW50KTsgLy8gUGFzcyBjb250ZW50IHRvIGNyZWF0ZVNpZGVNZW51XG4gIGNvbnRlbnQuYXBwZW5kQ2hpbGQodG9kb0NvbnRhaW5lcik7IC8vIEFwcGVuZCB0b2RvIGNvbnRhaW5lciB0byBjb250ZW50XG4gIGluaXRIYW5kbGVyKCk7XG4gIGNyZWF0ZUZvb3RlcigpO1xufVxuXG5cblxuZXhwb3J0IHsgaW5pdFdlYnNpdGUsIGNyZWF0ZUNvbnRlbnQgfTtcbiIsImltcG9ydCB7IGluaXRXZWJzaXRlIH0gZnJvbSBcIi4vd2Vic2l0ZVwiO1xuXG5pbml0V2Vic2l0ZSgpO1xuXG4iXSwibmFtZXMiOlsiY3JlYXRlTW9kYWwiLCJtb2RhbCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImlkIiwiY2xhc3NMaXN0IiwiYWRkIiwibW9kYWxDb250ZW50IiwiY2xvc2VCdG4iLCJpbm5lckhUTUwiLCJuYW1lTGFiZWwiLCJjcmVhdGVMYWJlbCIsIm5hbWVJbnB1dCIsImNyZWF0ZUlucHV0IiwiZGF0ZUxhYmVsIiwiZGF0ZUlucHV0Iiwic3VibWl0QnRuIiwidGV4dENvbnRlbnQiLCJhcHBlbmRDaGlsZCIsInRleHQiLCJodG1sRm9yIiwibGFiZWwiLCJzZXRBdHRyaWJ1dGUiLCJ0eXBlIiwicmVxdWlyZWQiLCJpbnB1dCIsImNsb3NlIiwicXVlcnlTZWxlY3RvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJzdHlsZSIsImRpc3BsYXkiLCJjb25zb2xlIiwibG9nIiwicmVtb3ZlIiwic3VibWl0VG9kbyIsImdldEVsZW1lbnRCeUlkIiwidG9kb0xpc3QiLCJ0b2RvSXRlbVdyYXBwZXIiLCJ0b2RvTmFtZSIsInZhbHVlIiwidG9kb0RhdGUiLCJ0b2RvSXRlbSIsImNoZWNrbWFya1NwYW4iLCJjaGVja2JveCIsIm5hbWVFbGVtZW50IiwiZGF0ZUVsZW1lbnQiLCJEYXRlIiwic29ydGVkVG9kb0l0ZW1zIiwiQXJyYXkiLCJmcm9tIiwiY2hpbGRyZW4iLCJzb3J0IiwiYSIsImIiLCJmb3JFYWNoIiwiaXRlbSIsInBhcmVudEVsZW1lbnQiLCJjaGVja2VkIiwic2V0VGltZW91dCIsIndpbmRvdyIsImFkZFByb2plY3RCdG4iLCJwcm9qZWN0RGl2IiwiY2xpY2tIYW5kbGVyIiwiaW5wdXRFbGVtZW50IiwicGxhY2Vob2xkZXIiLCJjYW5jZWxCdG4iLCJjb250YWluZXIiLCJwcm9qZWN0TmFtZSIsInRyaW0iLCJwcm9qZWN0SXRlbSIsInByb2plY3ROYW1lQnRuIiwiZGVsZXRlQnRuIiwicHJvamVjdFRvZG9MaXN0IiwiZGF0YXNldCIsInByb2plY3QiLCJhZGRUb2RvQnRuIiwiY2xvc2VNb2RhbCIsInByb2plY3RUb2RvSXRlbVdyYXBwZXIiLCJzdWJtaXRIYW5kbGVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwidGFyZ2V0Q2hlY2tib3giLCJ0YXJnZXQiLCJ0YWdOYW1lIiwiY2xvc2VzdCIsInN1Ym1pdFRvZG9Gb3JQcm9qZWN0IiwicXVlcnlTZWxlY3RvckFsbCIsImxpc3QiLCJhbGVydCIsImhlYWRlciIsInRpdGxlIiwiYm9keSIsImNyZWF0ZUhlYWRlciIsImNvbnRlbnQiLCJjcmVhdGVDb250ZW50IiwidG9kb0NvbnRhaW5lciIsInRvZG9CdG4iLCJjcmVhdGVUb2RvTGlzdCIsInNpZGVNZW51IiwiY3JlYXRlQnV0dG9uIiwiYnV0dG9uIiwiaG9tZSIsImluYm94QnRuIiwiY3JlYXRlU2lkZU1lbnUiLCJhY3RpdmVCdG4iLCJjb250YWlucyIsImluYm94SGFuZGxlciIsImZvb3RlciIsImZvb3RlckxpbmsiLCJjb3B5cmlnaHQiLCJsaW5rIiwiY3JlYXRlRm9vdGVyTGluayIsImNyZWF0ZUZvb3RlciIsImluaXRXZWJzaXRlIl0sInNvdXJjZVJvb3QiOiIifQ==